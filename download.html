<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Скачать ARDA - Academic Records Data Application</title>
<style>
* {margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
body {background:#f8fafc; color:#334155; line-height:1.6;}
.container {max-width:1200px; margin:0 auto; padding:0 20px;}

/* Хедер */
header {background:linear-gradient(135deg,#4f46e5,#7c3aed); color:white; padding:1rem 0; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);}
.header-content {display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;}
.logo {font-size:1.5rem; font-weight:bold; display:flex; align-items:center; gap:0.5rem;}
.logo-badge {background:rgba(255,255,255,0.2); padding:0.25rem 0.75rem; border-radius:1rem; font-size:0.875rem; font-weight:600;}
nav ul {display:flex; list-style:none; gap:1.5rem; flex-wrap:wrap;}
nav a {color:white; text-decoration:none; padding:0.5rem 1rem; border-radius:0.375rem; transition:all 0.3s; font-weight:500;}
nav a:hover, nav a.active {background-color:rgba(255,255,255,0.15); box-shadow:0 2px 4px rgba(0,0,0,0.1);}

/* Герой-блок */
.hero {text-align:center; padding:3rem 0 1rem;}
.version-badge {display:inline-block; background:linear-gradient(135deg,#10b981,#059669); color:white; padding:0.5rem 1.5rem; border-radius:2rem; font-weight:bold; font-size:1.25rem; margin-bottom:1rem; box-shadow:0 4px 6px -1px rgba(16,185,129,0.3);}
h1 {color:#1e293b; margin-bottom:1rem; font-size:2.5rem;}
.subtitle {color:#64748b; font-size:1.125rem; max-width:600px; margin:0 auto 2rem;}

/* Счетчики */
.stats-grid {display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:1.5rem; margin:2rem 0;}
.stat-card {background:white; border-radius:1rem; padding:1.5rem; text-align:center; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1); border:1px solid #e2e8f0;}
.stat-card:nth-child(1) {border-top:4px solid #4f46e5;}
.stat-card:nth-child(2) {border-top:4px solid #10b981;}
.stat-card:nth-child(3) {border-top:4px solid #f59e0b;}
.stat-card:nth-child(4) {border-top:4px solid #8b5cf6;}

.stat-number {font-size:2.5rem; font-weight:bold; margin:0.5rem 0; color:#1e293b;}
.stat-number.downloads {color:#4f46e5;}
.stat-number.visitors {color:#10b981;}
.stat-number.unique {color:#f59e0b;}
.stat-number.today {color:#8b5cf6;}

.stat-label {color:#64748b; font-size:0.9rem; margin-bottom:0.5rem;}
.stat-subtitle {font-size:0.8rem; color:#94a3b8; margin-top:0.5rem;}

/* Счетчик скачиваний */
.download-counter {background:linear-gradient(135deg, #6366f1, #8b5cf6); color:white; padding:1rem 1.5rem; border-radius:1rem; text-align:center; margin:1.5rem auto; max-width:400px; box-shadow:0 10px 15px -3px rgba(99,102,241,0.3);}
.counter-title {font-size:1.1rem; margin-bottom:0.5rem; font-weight:500;}
.counter-number {font-size:3rem; font-weight:bold; text-shadow:0 2px 4px rgba(0,0,0,0.2); margin:0.5rem 0;}
.counter-label {font-size:1rem; opacity:0.9;}

/* Основная сетка */
.main-grid {display:grid; grid-template-columns:2fr 1fr; gap:2rem; margin:2rem 0;}

/* Карточки */
.card {background:white; border-radius:1rem; padding:2rem; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1); border:1px solid #e2e8f0;}
.card-header {display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem; padding-bottom:1rem; border-bottom:2px solid #f1f5f9;}
h2 {color:#1e293b; font-size:1.5rem;}
.status-badge {padding:0.375rem 1rem; border-radius:0.5rem; font-size:0.875rem; font-weight:600;}
.status-stable {background-color:#d1fae5; color:#065f46;}
.status-outdated {background-color:#fee2e2; color:#991b1b;}

/* Сетки для загрузок и системных требований */
.download-grid {display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:1rem; margin:1.5rem 0;}
.download-card {background:linear-gradient(135deg,#f8fafc,#f1f5f9); border-radius:0.75rem; padding:1.5rem; border:2px solid #e2e8f0; transition:all 0.3s ease;}
.download-card:hover {border-color:#4f46e5; transform:translateY(-2px); box-shadow:0 10px 15px -3px rgba(79,70,229,0.1);}
.download-card h3 {color:#1e293b; margin-bottom:0.5rem; font-size:1.125rem;}
.download-card p {color:#64748b; font-size:0.875rem; margin-bottom:1rem;}

/* Кнопки */
.btn {display:inline-flex; align-items:center; justify-content:center; gap:0.5rem; background:linear-gradient(135deg,#4f46e5,#7c3aed); color:white; padding:0.75rem 1.5rem; text-decoration:none; border-radius:0.5rem; font-weight:600; transition:all 0.3s ease; width:100%; border:none; cursor:pointer;}
.btn:hover {transform:translateY(-1px); box-shadow:0 10px 15px -3px rgba(79,70,229,0.3);}
.btn-secondary {background:linear-gradient(135deg,#64748b,#475569);}

/* Списки функций */
.feature-list {list-style:none; margin:1rem 0; padding-left:0;}
.feature-list li {padding:0.5rem 0; display:flex; align-items:center; gap:0.75rem;}
.feature-list li:before {content:"✓"; background:#10b981; color:white; width:1.25rem; height:1.25rem; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:0.75rem;}

/* Блоки информации */
.info-box {background:linear-gradient(135deg,#f0f9ff,#e0f2fe); border-left:4px solid #0ea5e9; padding:1.25rem; border-radius:0.5rem; margin:1.5rem 0;}
.warning-box {background:linear-gradient(135deg,#fef3c7,#fde68a); border-left:4px solid #f59e0b; padding:1.25rem; border-radius:0.5rem; margin:1.5rem 0;}

/* Сайдбар */
.sidebar {display:flex; flex-direction:column; gap:1.5rem;}
.sidebar-card {background:white; border-radius:1rem; padding:1.5rem; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1); border:1px solid #e2e8f0;}

/* Системные требования */
.requirements-grid {display:grid; gap:0.75rem; margin:1rem 0;}
.requirement-item {display:flex; justify-content:space-between; padding:0.5rem 0; border-bottom:1px solid #f1f5f9;}
.requirement-label {color:#64748b;}
.requirement-value {color:#1e293b; font-weight:500;}

/* История версий */
.version-history {display:flex; flex-direction:column; gap:1rem; margin-top:1rem;}
.version-history div {padding:1rem; border-radius:0.5rem;}
.v-6-1 {background:#e0f2fe; border-left:4px solid #0ea5e9;}
.v-6-0 {background:#fee2e2; border-left:4px solid #f87171;}
.v-5-5 {background:#f0f9e8; border-left:4px solid #10b981;}
.v-5-0 {background:#f0f0f0; border-left:4px solid #94a3b8;}
.v-3-39 {background:#e0f2fe; border-left:4px solid #0ea5e9;}
.v-3-3 {background:#f0f9e8; border-left:4px solid #10b981;}
.v-3-29 {background:#f0f0f0; border-left:4px solid #94a3b8;}
.v-3-2 {background:#e0f2fe; border-left:4px solid #0ea5e9;}
.v-3-1 {background:#f0f9e8; border-left:4px solid #10b981;}
.v-3-0 {background:#f0f0f0; border-left:4px solid #94a3b8;}
.v-1-9 {background:#e0f2fe; border-left:4px solid #0ea5e9;}

/* Активность пользователей */
.activity-list {max-height:200px; overflow-y:auto; margin-top:1rem;}
.activity-item {padding:0.75rem; border-bottom:1px solid #f1f5f9; display:flex; align-items:center; gap:0.75rem;}
.activity-item:last-child {border-bottom:none;}
.activity-icon {width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:0.75rem; font-weight:bold; color:white;}
.activity-icon.download {background-color:#4f46e5;}
.activity-icon.visit {background-color:#10b981;}
.activity-icon.new {background-color:#f59e0b;}
.activity-content {flex:1;}
.activity-time {font-size:0.75rem; color:#94a3b8;}

/* Футер */
footer {background:#1e293b; color:white; padding:2rem 0; margin-top:3rem;}
.footer-content {display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;}
.footer-content div {margin-bottom:0.5rem;}
.footer-content p {margin:0; font-size:0.875rem; color:#94a3b8;}

@media(max-width:768px){
    .main-grid {grid-template-columns:1fr; gap:2rem;}
    .stats-grid {grid-template-columns:1fr;}
    h1 {font-size:2rem;}
    .header-content, .footer-content {flex-direction:column; text-align:center;}
    .counter-number {font-size:2.5rem;}
    .stat-number {font-size:2rem;}
}
</style>
</head>
<body>

<header>
<div class="container header-content">
    <div class="logo">
        ARDA Manager
        <span class="logo-badge">v6.1 RELEASE</span>
    </div>
    <nav>
        <ul>
            <li><a href="index.html">Главная</a></li>
            <li><a href="functions.html">Функции</a></li>
            <li><a href="download.html" class="active">Скачать</a></li>
            <li><a href="doc.html">Документация</a></li>
        </ul>
    </nav>
</div>
</header>

<div class="container">
<div class="hero">
    <div class="version-badge">ARDA 6.1 RELEASE</div>
    <h1>Скачайте самую новую версию</h1>
    <p class="subtitle">Исправлены баги, оптимизирован код и добавлена корректная работа с JSON в меню уроков</p>
</div>

<!-- Сетка статистики -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">Всего скачиваний</div>
        <div class="stat-number downloads" id="totalDownloads">0</div>
        <div class="stat-subtitle">за всё время</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-label">Посетителей сегодня</div>
        <div class="stat-number visitors" id="todayVisitors">0</div>
        <div class="stat-subtitle">из них уникальных</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-label">Уникальных посетителей</div>
        <div class="stat-number unique" id="uniqueVisitors">0</div>
        <div class="stat-subtitle">всего за всё время</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-label">Сейчас на сайте</div>
        <div class="stat-number today" id="onlineNow">0</div>
        <div class="stat-subtitle">активных пользователей</div>
    </div>
</div>

<!-- Блок активных пользователей -->
<div class="card">
    <div class="card-header">
        <h2>Последняя активность</h2>
        <span class="status-badge status-stable">LIVE</span>
    </div>
    <div class="activity-list" id="activityList">
        <!-- Сюда будут добавляться активности динамически -->
    </div>
</div>

<!-- Счетчик скачиваний -->
<div class="download-counter" id="downloadCounter">
    <div class="counter-title">Нас уже скачали</div>
    <div class="counter-number" id="counterNumber">0</div>
    <div class="counter-label">пользователей</div>
</div>

<div class="main-grid">

<!-- Контент слева -->
<div>

<!-- Версия 6.1 -->
<div class="card">
    <div class="card-header">
        <h2>ARDA 6.1</h2>
        <span class="status-badge status-stable">Рекомендуется</span>
    </div>
    <div class="info-box">
        <strong>Что нового:</strong>
        <ul class="feature-list">
            <li>Убраны критические баги</li>
            <li>Оптимизирован код</li>
            <li>Корректная работа с JSON</li>
        </ul>
    </div>
    <div class="warning-box">
        <strong>Важно:</strong> Редактирование JSON напрямую не поддерживается. Используйте меню уроков для изменения файлов.
    </div>
    <div class="download-grid">
        <div class="download-card">
            <h3>Скачать ARDA 6.1</h3>
            <p>Полная версия для Windows</p>
            <button class="btn" onclick="trackDownload()">Скачать</button>
        </div>
    </div>
</div>

<!-- История версий -->
<div class="card" style="margin-top:2rem;">
    <div class="card-header"><h2>История версий ARDA</h2></div>
    <div class="version-history">
        <div class="v-6-1"><strong>ARDA 6.1</strong> – 01-02-2026: Убраны баги, оптимизирован код, корректная работа с JSON.</div>
        <div class="v-6-0"><strong>ARDA 6.0</strong> – 01-01-2026: Основная функциональная версия, но содержала критический баг.</div>
        <div class="v-5-5"><strong>ARDA 5.5</strong> – 11-12-2025: Исправлены ошибки, улучшена производительность.</div>
        <div class="v-5-0"><strong>ARDA 5.0</strong> – 10-11-2025: Новые функции для расписаний и PDF.</div>
        <div class="v-3-39"><strong>ARDA 3.39</strong> – 02-11-2025: Мелкие исправления интерфейса.</div>
        <div class="v-3-3"><strong>ARDA 3.3</strong> – 31-10-2025: Оптимизация кода и совместимость.</div>
        <div class="v-3-29"><strong>ARDA 3.29</strong> – 22-10-2025: Улучшена работа с учебными планами.</div>
        <div class="v-3-2"><strong>ARDA 3.2</strong> – 18-10-2025: Мелкие багфиксы и стабильность.</div>
        <div class="v-3-1"><strong>ARDA 3.1</strong> – 20-09-2025: Исправлены ошибки и улучшен интерфейс.</div>
        <div class="v-3-0"><strong>ARDA 3.0</strong> – 06-09-2025: Большой апгрейд интерфейса и функционала.</div>
        <div class="v-1-9"><strong>ARDA 1.9</strong> – 01-05-2025: Первая стабильная версия с базовым функционалом.</div>
    </div>
</div>

</div>

<!-- Сайдбар справа -->
<div class="sidebar">

<div class="sidebar-card">
    <h3>Системные требования</h3>
    <div class="requirements-grid">
        <div class="requirement-item"><span class="requirement-label">ОС:</span><span class="requirement-value">Windows 10/11 x64</span></div>
        <div class="requirement-item"><span class="requirement-label">Процессор:</span><span class="requirement-value">Любой современный</span></div>
        <div class="requirement-item"><span class="requirement-label">ОЗУ:</span><span class="requirement-value">256 МБ минимум</span></div>
        <div class="requirement-item"><span class="requirement-label">Место на диске:</span><span class="requirement-value">500 МБ</span></div>
    </div>
</div>

<div class="sidebar-card">
    <h3>Как установить</h3>
    <ol style="margin-top:1rem; color:#475569;">
        <li>Скачайте установочный файл</li>
        <li>Запустите установщик</li>
        <li>Следуйте инструкциям на экране</li>
        <li>Запустите ARDA из меню Пуск</li>
    </ol>
</div>

<div class="sidebar-card">
    <h3>Поддержка</h3>
    <p style="color:#64748b; margin-top:0.5rem; font-size:0.875rem;">
        Для вопросов и поддержки: niyazyangerman@gmail.com
    </p>
    <a href="#" class="btn btn-secondary" style="margin-top:1rem;">Документация</a>
</div>

</div>

</div>
</div>

<footer>
<div class="container">
<div class="footer-content">
    <div>
        <p style="font-weight:600;">ARDA Manager</p>
        <p>© 2026 Academic Records Data Application. Все права защищены.</p>
    </div>
    <div>
        <p>Посетителей сегодня: <span id="footerVisitors">0</span> | Онлайн: <span id="footerOnline">0</span></p>
    </div>
</div>
</footer>

<script>
// Глобальные переменные для статистики
let stats = {
    totalDownloads: 0,
    todayVisitors: 0,
    uniqueVisitors: 0,
    onlineNow: 0,
    todayDate: '',
    activities: []
};

// Генерация уникального ID для пользователя
function generateVisitorId() {
    return 'visitor_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now().toString(36);
}

// Получение текущей даты в формате YYYY-MM-DD
function getTodayDate() {
    const now = new Date();
    return now.toISOString().split('T')[0];
}

// Загрузка статистики из localStorage
function loadStats() {
    const savedStats = localStorage.getItem('ardaStats');
    const today = getTodayDate();
    
    if (savedStats) {
        stats = JSON.parse(savedStats);
        
        // Сброс счетчика сегодняшних посетителей, если день изменился
        if (stats.todayDate !== today) {
            stats.todayVisitors = 0;
            stats.todayDate = today;
            stats.onlineNow = 0;
        }
    } else {
        // Начальные значения
        stats = {
            totalDownloads: 0,
            todayVisitors: 0,
            uniqueVisitors: 0,
            onlineNow: 0,
            todayDate: today,
            activities: []
        };
    }
    
    // Проверяем, есть ли у пользователя ID
    let visitorId = localStorage.getItem('ardaVisitorId');
    let isNewVisitor = false;
    
    if (!visitorId) {
        visitorId = generateVisitorId();
        localStorage.setItem('ardaVisitorId', visitorId);
        isNewVisitor = true;
        stats.uniqueVisitors++;
    }
    
    // Проверяем, был ли пользователь сегодня
    const todayVisits = JSON.parse(localStorage.getItem('ardaTodayVisits') || '{}');
    if (!todayVisits[visitorId]) {
        stats.todayVisitors++;
        todayVisits[visitorId] = true;
        localStorage.setItem('ardaTodayVisits', JSON.stringify(todayVisits));
        isNewVisitor = true;
    }
    
    // Увеличиваем счетчик онлайн пользователей
    stats.onlineNow++;
    
    // Добавляем активность
    const activityTime = new Date().toLocaleTimeString('ru-RU', { 
        hour: '2-digit', 
        minute: '2-digit' 
    });
    
    const activity = {
        type: isNewVisitor ? 'new' : 'visit',
        time: activityTime,
        visitorId: visitorId.substring(0, 8) + '...'
    };
    
    stats.activities.unshift(activity);
    if (stats.activities.length > 10) {
        stats.activities = stats.activities.slice(0, 10);
    }
    
    // Сохраняем обновленную статистику
    saveStats();
    
    return { visitorId, isNewVisitor };
}

// Сохранение статистики в localStorage
function saveStats() {
    localStorage.setItem('ardaStats', JSON.stringify(stats));
}

// Обновление отображения статистики
function updateStatsDisplay() {
    // Основные счетчики
    document.getElementById('totalDownloads').textContent = stats.totalDownloads.toLocaleString('ru-RU');
    document.getElementById('todayVisitors').textContent = stats.todayVisitors.toLocaleString('ru-RU');
    document.getElementById('uniqueVisitors').textContent = stats.uniqueVisitors.toLocaleString('ru-RU');
    document.getElementById('onlineNow').textContent = stats.onlineNow.toLocaleString('ru-RU');
    
    // Счетчик скачиваний
    document.getElementById('counterNumber').textContent = stats.totalDownloads.toLocaleString('ru-RU');
    
    // Футер
    document.getElementById('footerVisitors').textContent = stats.todayVisitors;
    document.getElementById('footerOnline').textContent = stats.onlineNow;
    
    // Обновляем список активностей
    updateActivitiesList();
}

// Обновление списка активностей
function updateActivitiesList() {
    const activityList = document.getElementById('activityList');
    activityList.innerHTML = '';
    
    stats.activities.forEach(activity => {
        const activityItem = document.createElement('div');
        activityItem.className = 'activity-item';
        
        let iconClass = 'visit';
        let iconText = 'V';
        let activityText = 'Посетитель зашел на сайт';
        
        if (activity.type === 'download') {
            iconClass = 'download';
            iconText = 'D';
            activityText = 'Пользователь скачал ARDA';
        } else if (activity.type === 'new') {
            iconClass = 'new';
            iconText = 'N';
            activityText = 'Новый посетитель на сайте';
        }
        
        activityItem.innerHTML = `
            <div class="activity-icon ${iconClass}">${iconText}</div>
            <div class="activity-content">
                <div>${activityText}</div>
                <div class="activity-time">${activity.time} • ID: ${activity.visitorId}</div>
            </div>
        `;
        
        activityList.appendChild(activityItem);
    });
}

// Трекер скачивания
function trackDownload() {
    // Увеличиваем счетчик скачиваний
    stats.totalDownloads++;
    
    // Добавляем активность скачивания
    const activityTime = new Date().toLocaleTimeString('ru-RU', { 
        hour: '2-digit', 
        minute: '2-digit' 
    });
    
    const visitorId = localStorage.getItem('ardaVisitorId') || 'anonymous';
    
    const activity = {
        type: 'download',
        time: activityTime,
        visitorId: visitorId.substring(0, 8) + '...'
    };
    
    stats.activities.unshift(activity);
    if (stats.activities.length > 10) {
        stats.activities = stats.activities.slice(0, 10);
    }
    
    // Сохраняем статистику
    saveStats();
    
    // Обновляем отображение
    updateStatsDisplay();
    
    // Анимация увеличения счетчика
    const counterElement = document.getElementById('counterNumber');
    counterElement.style.transform = 'scale(1.2)';
    counterElement.style.color = '#10b981';
    
    setTimeout(() => {
        counterElement.style.transform = 'scale(1)';
        counterElement.style.color = 'white';
    }, 300);
    
    // Перенаправляем на скачивание после небольшой задержки
    setTimeout(() => {
        window.open('https://disk.yandex.ru/d/KXwv7zIJhFlQTg', '_blank');
    }, 500);
}

// Симуляция онлайн пользователей (обновляется каждую минуту)
function simulateOnlineUsers() {
    // Случайные колебания онлайн пользователей
    const change = Math.floor(Math.random() * 3) - 1; // -1, 0, или 1
    stats.onlineNow = Math.max(1, stats.onlineNow + change);
    
    // Периодически добавляем новые активности
    if (Math.random() < 0.3 && stats.activities.length > 0) {
        const activityTime = new Date().toLocaleTimeString('ru-RU', { 
            hour: '2-digit', 
            minute: '2-digit' 
        });
        
        const activityTypes = ['visit', 'new', 'download'];
        const randomType = activityTypes[Math.floor(Math.random() * activityTypes.length)];
        
        const activity = {
            type: randomType,
            time: activityTime,
            visitorId: 'visitor_' + Math.random().toString(36).substr(2, 6)
        };
        
        stats.activities.unshift(activity);
        if (stats.activities.length > 10) {
            stats.activities = stats.activities.slice(0, 10);
        }
    }
    
    saveStats();
    updateStatsDisplay();
}

// Анимация счетчиков при загрузке
function animateCounters() {
    const counters = document.querySelectorAll('.stat-number');
    
    counters.forEach(counter => {
        const finalValue = parseInt(counter.textContent.replace(/\s/g, ''));
        const duration = 1500;
        const startTime = Date.now();
        const startValue = 0;
        
        function update() {
            const elapsed = Date.now() - startTime;
            const progress = Math.min(elapsed / duration, 1);
            const easeProgress = 1 - Math.pow(1 - progress, 3); // Кубическое замедление
            const currentValue = Math.floor(startValue + (finalValue - startValue) * easeProgress);
            
            counter.textContent = currentValue.toLocaleString('ru-RU');
            
            if (progress < 1) {
                requestAnimationFrame(update);
            }
        }
        
        requestAnimationFrame(update);
    });
}

// Инициализация при загрузке страницы
document.addEventListener('DOMContentLoaded', function() {
    // Загружаем статистику и отслеживаем посетителя
    loadStats();
    
    // Обновляем отображение
    updateStatsDisplay();
    
    // Запускаем анимацию счетчиков
    setTimeout(animateCounters, 500);
    
    // Добавляем клик на блоке счетчика
    document.getElementById('downloadCounter').addEventListener('click', trackDownload);
    
    // Запускаем симуляцию онлайн пользователей
    setInterval(simulateOnlineUsers, 60000); // Каждую минуту
    
    // Обновляем время онлайн пользователя
    setInterval(() => {
        // Эта функция поддерживает сессию пользователя
        const onlineUsers = JSON.parse(localStorage.getItem('ardaOnlineUsers') || '{}');
        const visitorId = localStorage.getItem('ardaVisitorId');
        
        if (visitorId) {
            onlineUsers[visitorId] = Date.now();
            localStorage.setItem('ardaOnlineUsers', JSON.stringify(onlineUsers));
        }
    }, 30000); // Каждые 30 секунд
    
    // Очистка старых онлайн пользователей (тех, кто не активен более 5 минут)
    setInterval(() => {
        const onlineUsers = JSON.parse(localStorage.getItem('ardaOnlineUsers') || '{}');
        const fiveMinutesAgo = Date.now() - 5 * 60 * 1000;
        let activeCount = 0;
        
        Object.keys(onlineUsers).forEach(key => {
            if (onlineUsers[key] > fiveMinutesAgo) {
                activeCount++;
            }
        });
        
        stats.onlineNow = Math.max(1, activeCount);
        saveStats();
        updateStatsDisplay();
    }, 60000); // Каждую минуту
});

// Обработка ухода пользователя со страницы
window.addEventListener('beforeunload', function() {
    // Уменьшаем счетчик онлайн пользователей
    if (stats.onlineNow > 0) {
        stats.onlineNow--;
    }
    saveStats();
});
</script>

</body>
</html>
